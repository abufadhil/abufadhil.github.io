<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Document</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"></script>
</head>
<body class="bg-secondary">
    <div class="container text-white">
        <div class="title text-center mt-5">
            <span>Kartu Idul Fitri <b>SD IT As Sunnah</b></span>
        </div>

        <hr>

        <canvas id="canvas-gambar" class="img-fluid text-center" width="4000" height="5590"></canvas>

        <hr>

        <input type="text" id="txt" name="nama" class="form-control form-control-sm" placeholder="Masukkan Nama Anda">

        <div class="mt-3">
            <button id="btn" onclick="showImg()" class="btn btn-sm btn-primary" style="font-size:18px; text-align:right;">Tampilkan</button>
		    <button id="save" onclick="saveImg()" class="btn btn-sm btn-success d-none" style="font-size:18px; text-align:right;">Simpan</button>
        </div>

        <div class="alert alert-info mt-3">
            <ul dir="ltr" style="list-style-type: none; padding-left:0%; ">
                <li>- Untuk menyimpan gambar dari komputer, klik kanan gambar dan pilih <b>Simpan Gambar</b></li>
                <li>- Untuk menyimpan gambar dari ponsel, klik pada gambar selama dua detik dan pilih <b>Simpan Gambar</b> </li>
            </ul>
        </div>
    </div>

    <a id="unduh"></a>

    <script>
        function saveImg() {
            var canvas = document.getElementById("canvas-gambar");

            var img = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");
            // img.crossOrigin="anonymous";

            let unduh = document.querySelector('#unduh');
            unduh.setAttribute('download', 'kartu-idul-fitri-al-irsyad.png');
            unduh.setAttribute('href', img);
            unduh.click();
        }

        function showImg() {
            var element = document.getElementById("save");
            element.classList.remove("d-none");

			var str1="";
			var str2="";
            var name = document.getElementById("txt").value;
			var res = str1.concat(name, str2);
            var canvas = document.getElementById("canvas-gambar");
            var context = canvas.getContext("2d");
            //context.clearRect(0, 0, 4000, 3000);
            context.clearRect(0, 0,1080, 1080);
            var fontsize = 130;

            if (name.length > 24) {
                fontsize = 130 - (name.length - 24);
            }
            //alert(name.length);
            var imageObj = new Image();
            imageObj.onload = function () {
                //context.scale(0.15, 0.15);
                context.drawImage(imageObj, 0, 0);
                context.font = "bold "+ fontsize + "px hpsimplified";
                context.fillStyle = "#ffffff";
                context.textAlign = "center";
                context.fillText(res, 1250, 1250);

                

            };

            imageObj.src = "img/Assunnah.jpg";
        }

        window.onload = function () {
            var canvas = document.getElementById("canvas-gambar");
            var context = canvas.getContext("2d");
            var imageObj = new Image();
            imageObj.onload = function () {
                //context.scale(0.15, 0.15);
                context.drawImage(imageObj, 0, 0);
                context.font = "bold 100x hpsimplified";
                context.fillStyle = "#ffffff";
                context.textAlign = "center";
                context.fillText("~ SD IT As Sunnah ~", 1250, 1250);

            };

            imageObj.src = "img/Assunnah.jpg";
        };
    </script>
</body>
</html>
